BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2729786969.91542
 ALGERIA                   |   1997 | 4641304635.76793
 ALGERIA                   |   1996 | 4655376686.99406
 ALGERIA                   |   1995 |  4646517113.4524
 ALGERIA                   |   1994 | 4637120132.46069
 ALGERIA                   |   1993 | 4638110935.21294
 ALGERIA                   |   1992 | 4675225188.93351
 ARGENTINA                 |   1998 |  2730892403.1944
 ARGENTINA                 |   1997 | 4641535966.15643
 ARGENTINA                 |   1996 | 4677917553.19305
 ARGENTINA                 |   1995 |  4655520673.2202
 ARGENTINA                 |   1994 | 4637954913.53323
 ARGENTINA                 |   1993 | 4652181509.42023
 ARGENTINA                 |   1992 |  4674069108.2206
 BRAZIL                    |   1998 |  2735538534.0831
 BRAZIL                    |   1997 | 4677099821.02828
 BRAZIL                    |   1996 | 4669558976.79977
 BRAZIL                    |   1995 | 4652878227.99574
 BRAZIL                    |   1994 | 4666793952.72859
 BRAZIL                    |   1993 | 4660700271.13577
 BRAZIL                    |   1992 | 4683298715.88457
 CANADA                    |   1998 | 2765314647.49102
 CANADA                    |   1997 | 4689067474.77275
 CANADA                    |   1996 | 4679969419.15005
 CANADA                    |   1995 | 4707441768.89201
 CANADA                    |   1994 | 4669307736.02113
 CANADA                    |   1993 | 4683455020.20639
 CANADA                    |   1992 | 4703955988.16037
 CHINA                     |   1998 | 2744370439.70459
 CHINA                     |   1997 |  4676160676.4617
 CHINA                     |   1996 | 4713958698.37975
 CHINA                     |   1995 | 4658533460.08161
 CHINA                     |   1994 | 4685663232.15475
 CHINA                     |   1993 | 4663135190.90008
 CHINA                     |   1992 | 4714666894.55177
 EGYPT                     |   1998 | 2726087029.06369
 EGYPT                     |   1997 | 4631967062.68038
 EGYPT                     |   1996 | 4632731177.66344
 EGYPT                     |   1995 | 4658848087.12459
 EGYPT                     |   1994 | 4657403306.07062
 EGYPT                     |   1993 | 4659632666.26827
 EGYPT                     |   1992 | 4665146448.41789
 ETHIOPIA                  |   1998 | 2742106973.19276
 ETHIOPIA                  |   1997 | 4662754289.33996
 ETHIOPIA                  |   1996 | 4701490972.53205
 ETHIOPIA                  |   1995 | 4657590094.55053
 ETHIOPIA                  |   1994 | 4662970381.68309
 ETHIOPIA                  |   1993 | 4680622559.20571
 ETHIOPIA                  |   1992 | 4674471583.00799
 FRANCE                    |   1998 | 2764439534.52054
 FRANCE                    |   1997 | 4693961588.56419
 FRANCE                    |   1996 | 4728540191.24456
 FRANCE                    |   1995 | 4700065978.84224
 FRANCE                    |   1994 | 4693704593.09117
 FRANCE                    |   1993 | 4702724085.64593
 FRANCE                    |   1992 | 4718249739.77522
 GERMANY                   |   1998 | 2765772527.69447
 GERMANY                   |   1997 | 4699305393.81352
 GERMANY                   |   1996 | 4712042135.39082
 GERMANY                   |   1995 | 4696757048.70519
 GERMANY                   |   1994 | 4688601411.93474
 GERMANY                   |   1993 | 4693190884.47976
 GERMANY                   |   1992 | 4708974154.97919
 INDIA                     |   1998 | 2726778845.43608
 INDIA                     |   1997 | 4662790049.43424
 INDIA                     |   1996 | 4656093249.47622
 INDIA                     |   1995 | 4661580282.70308
 INDIA                     |   1994 | 4676718190.02596
 INDIA                     |   1993 | 4662901544.24638
 INDIA                     |   1992 |  4654994338.6166
 INDONESIA                 |   1998 | 2720936548.80866
 INDONESIA                 |   1997 | 4654579123.39983
 INDONESIA                 |   1996 | 4622454365.49445
 INDONESIA                 |   1995 | 4646065207.17354
 INDONESIA                 |   1994 | 4646147687.69773
 INDONESIA                 |   1993 | 4643579315.03286
 INDONESIA                 |   1992 |  4658444302.9746
 IRAN                      |   1998 | 2741980297.14533
 IRAN                      |   1997 |  4666973235.9709
 IRAN                      |   1996 | 4649664958.13968
 IRAN                      |   1995 | 4655441420.14979
 IRAN                      |   1994 | 4664605436.39524
 IRAN                      |   1993 | 4649250606.90726
 IRAN                      |   1992 | 4647714086.19746
 IRAQ                      |   1998 | 2728523516.98037
 IRAQ                      |   1997 | 4676467847.47724
 IRAQ                      |   1996 | 4658029112.86042
 IRAQ                      |   1995 | 4635371976.31386
 IRAQ                      |   1994 | 4647243928.84122
 IRAQ                      |   1993 | 4657052544.32779
 IRAQ                      |   1992 | 4671887818.24014
 JAPAN                     |   1998 | 2736322460.01136
 JAPAN                     |   1997 | 4651459838.49692
 JAPAN                     |   1996 | 4660819756.45419
 JAPAN                     |   1995 | 4662414082.37343
 JAPAN                     |   1994 | 4623845189.63561
 JAPAN                     |   1993 | 4639396732.34606
 JAPAN                     |   1992 | 4648879642.79101
 JORDAN                    |   1998 | 2745119269.48801
 JORDAN                    |   1997 | 4660142834.22931
 JORDAN                    |   1996 | 4660913977.48475
 JORDAN                    |   1995 | 4635947012.05852
 JORDAN                    |   1994 | 4658383401.03965
 JORDAN                    |   1993 | 4653242734.86523
 JORDAN                    |   1992 | 4654393714.40247
 KENYA                     |   1998 | 2714639501.04673
 KENYA                     |   1997 | 4625367449.74062
 KENYA                     |   1996 | 4649564528.45243
 KENYA                     |   1995 | 4614439330.12136
 KENYA                     |   1994 | 4632213299.44292
 KENYA                     |   1993 | 4616816790.47036
 KENYA                     |   1992 | 4655957950.33003
 MOROCCO                   |   1998 | 2735305679.29963
 MOROCCO                   |   1997 | 4676111352.23553
 MOROCCO                   |   1996 | 4710896754.35619
 MOROCCO                   |   1995 | 4684385088.41198
 MOROCCO                   |   1994 |  4674232582.9396
 MOROCCO                   |   1993 | 4692582486.06513
 MOROCCO                   |   1992 | 4698187842.54375
 MOZAMBIQUE                |   1998 | 2726191917.68767
 MOZAMBIQUE                |   1997 | 4670360373.36021
 MOZAMBIQUE                |   1996 | 4693213276.28796
 MOZAMBIQUE                |   1995 | 4667466900.26232
 MOZAMBIQUE                |   1994 | 4667268816.73756
 MOZAMBIQUE                |   1993 | 4669865004.40127
 MOZAMBIQUE                |   1992 | 4677190773.60893
 PERU                      |   1998 | 2719426247.91219
 PERU                      |   1997 | 4650292420.19358
 PERU                      |   1996 |  4664769521.3837
 PERU                      |   1995 | 4642319888.85452
 PERU                      |   1994 |  4656943548.5297
 PERU                      |   1993 | 4636631695.55641
 PERU                      |   1992 | 4651794522.75808
 ROMANIA                   |   1998 | 2736833658.05506
 ROMANIA                   |   1997 | 4674406816.08694
 ROMANIA                   |   1996 | 4680456159.85585
 ROMANIA                   |   1995 |   4662663737.361
 ROMANIA                   |   1994 | 4691755496.34452
 ROMANIA                   |   1993 |  4688522153.7165
 ROMANIA                   |   1992 | 4685969736.04042
 RUSSIA                    |   1998 | 2732022899.64032
 RUSSIA                    |   1997 | 4669076717.49492
 RUSSIA                    |   1996 | 4652635956.29127
 RUSSIA                    |   1995 |  4660675991.2288
 RUSSIA                    |   1994 |   4663423715.091
 RUSSIA                    |   1993 | 4637847387.31265
 RUSSIA                    |   1992 | 4674946475.03253
 SAUDI ARABIA              |   1998 | 2726396128.53962
 SAUDI ARABIA              |   1997 | 4658766028.17507
 SAUDI ARABIA              |   1996 | 4652943929.80062
 SAUDI ARABIA              |   1995 | 4656539982.68618
 SAUDI ARABIA              |   1994 | 4669584162.47102
 SAUDI ARABIA              |   1993 | 4645184216.18053
 SAUDI ARABIA              |   1992 | 4657475047.09461
 UNITED KINGDOM            |   1998 | 2777503346.32474
 UNITED KINGDOM            |   1997 |  4718475180.2425
 UNITED KINGDOM            |   1996 | 4704428065.69621
 UNITED KINGDOM            |   1995 | 4698487475.44203
 UNITED KINGDOM            |   1994 | 4718522506.43282
 UNITED KINGDOM            |   1993 | 4700598668.60328
 UNITED KINGDOM            |   1992 | 4742308464.69836
 UNITED STATES             |   1998 | 2732842078.06099
 UNITED STATES             |   1997 | 4681411043.34874
 UNITED STATES             |   1996 | 4682362147.78564
 UNITED STATES             |   1995 | 4682428183.84646
 UNITED STATES             |   1994 | 4678814041.90541
 UNITED STATES             |   1993 | 4659227719.03392
 UNITED STATES             |   1992 | 4677270994.35497
 VIETNAM                   |   1998 | 2743661570.83093
 VIETNAM                   |   1997 | 4650852253.08504
 VIETNAM                   |   1996 | 4705066014.70134
 VIETNAM                   |   1995 |  4717506963.2674
 VIETNAM                   |   1994 | 4684891974.84841
 VIETNAM                   |   1993 | 4680276948.07068
 VIETNAM                   |   1992 | 4683456921.82334
(175 rows)

COMMIT;
COMMIT
