BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2729776494.06509
 ALGERIA                   |   1997 | 4631972521.78286
 ALGERIA                   |   1996 | 4654690541.53613
 ALGERIA                   |   1995 | 4664594824.90398
 ALGERIA                   |   1994 | 4640180783.85479
 ALGERIA                   |   1993 | 4668175603.95132
 ALGERIA                   |   1992 | 4623307403.65826
 ARGENTINA                 |   1998 | 2728850192.87322
 ARGENTINA                 |   1997 | 4634670078.49975
 ARGENTINA                 |   1996 | 4662719722.39771
 ARGENTINA                 |   1995 | 4628922164.24798
 ARGENTINA                 |   1994 | 4646655030.23692
 ARGENTINA                 |   1993 | 4632111540.62312
 ARGENTINA                 |   1992 | 4632744960.12253
 BRAZIL                    |   1998 | 2761512214.47263
 BRAZIL                    |   1997 | 4661095930.87183
 BRAZIL                    |   1996 | 4678644177.74251
 BRAZIL                    |   1995 | 4662894441.01553
 BRAZIL                    |   1994 | 4663374537.45264
 BRAZIL                    |   1993 | 4679962081.25226
 BRAZIL                    |   1992 | 4651360722.00123
 CANADA                    |   1998 | 2741496262.54163
 CANADA                    |   1997 | 4651881204.03602
 CANADA                    |   1996 | 4670609128.44147
 CANADA                    |   1995 | 4645668504.53146
 CANADA                    |   1994 | 4643015449.01571
 CANADA                    |   1993 | 4662507003.71776
 CANADA                    |   1992 | 4677226684.32944
 CHINA                     |   1998 | 2752619000.32028
 CHINA                     |   1997 |  4673480041.7524
 CHINA                     |   1996 | 4700004540.67185
 CHINA                     |   1995 | 4662277975.72411
 CHINA                     |   1994 | 4666442354.96961
 CHINA                     |   1993 | 4652793375.15636
 CHINA                     |   1992 | 4695800743.74247
 EGYPT                     |   1998 | 2733006236.90482
 EGYPT                     |   1997 | 4648759481.32244
 EGYPT                     |   1996 | 4688101392.66922
 EGYPT                     |   1995 | 4677282711.86617
 EGYPT                     |   1994 | 4662054111.45212
 EGYPT                     |   1993 | 4676711244.52304
 EGYPT                     |   1992 | 4676599054.86508
 ETHIOPIA                  |   1998 | 2741619467.19607
 ETHIOPIA                  |   1997 | 4710740730.94267
 ETHIOPIA                  |   1996 | 4720977607.27637
 ETHIOPIA                  |   1995 | 4727179537.45701
 ETHIOPIA                  |   1994 | 4710580650.23197
 ETHIOPIA                  |   1993 | 4693095413.46167
 ETHIOPIA                  |   1992 | 4727946239.79471
 FRANCE                    |   1998 |  2759602060.7749
 FRANCE                    |   1997 | 4710042949.19953
 FRANCE                    |   1996 | 4724167370.42736
 FRANCE                    |   1995 | 4694142191.02736
 FRANCE                    |   1994 | 4723923395.77175
 FRANCE                    |   1993 | 4725733328.71754
 FRANCE                    |   1992 | 4718320983.03607
 GERMANY                   |   1998 | 2765044236.34008
 GERMANY                   |   1997 | 4674956561.58986
 GERMANY                   |   1996 | 4699278381.56845
 GERMANY                   |   1995 | 4656198793.22081
 GERMANY                   |   1994 | 4678807729.47912
 GERMANY                   |   1993 | 4704726231.63209
 GERMANY                   |   1992 | 4710452139.13275
 INDIA                     |   1998 |  2732862786.6611
 INDIA                     |   1997 | 4648861680.18414
 INDIA                     |   1996 | 4671020622.23622
 INDIA                     |   1995 | 4667063401.25906
 INDIA                     |   1994 |  4651996273.1812
 INDIA                     |   1993 | 4657486242.81024
 INDIA                     |   1992 | 4662854880.93758
 INDONESIA                 |   1998 | 2737113576.41985
 INDONESIA                 |   1997 | 4637136911.30411
 INDONESIA                 |   1996 |  4638597248.3568
 INDONESIA                 |   1995 | 4613179734.19187
 INDONESIA                 |   1994 | 4647618763.86129
 INDONESIA                 |   1993 |  4626053228.4033
 INDONESIA                 |   1992 | 4640131112.14846
 IRAN                      |   1998 | 2726640252.04962
 IRAN                      |   1997 | 4633005191.04545
 IRAN                      |   1996 | 4641290489.81172
 IRAN                      |   1995 | 4623652818.25673
 IRAN                      |   1994 | 4643857922.54503
 IRAN                      |   1993 | 4641726770.34122
 IRAN                      |   1992 | 4666409442.64389
 IRAQ                      |   1998 | 2713258277.85223
 IRAQ                      |   1997 | 4659761405.42747
 IRAQ                      |   1996 | 4657979968.85677
 IRAQ                      |   1995 | 4650825949.12632
 IRAQ                      |   1994 |  4639656516.3581
 IRAQ                      |   1993 | 4670773277.22943
 IRAQ                      |   1992 | 4661461067.18359
 JAPAN                     |   1998 | 2712332912.53522
 JAPAN                     |   1997 | 4642594914.87392
 JAPAN                     |   1996 | 4684888284.36347
 JAPAN                     |   1995 | 4668774141.10821
 JAPAN                     |   1994 | 4669747891.56007
 JAPAN                     |   1993 | 4644629431.59827
 JAPAN                     |   1992 | 4653744516.16205
 JORDAN                    |   1998 | 2731446283.69353
 JORDAN                    |   1997 |  4656199673.5205
 JORDAN                    |   1996 |  4677290941.1053
 JORDAN                    |   1995 | 4648020491.57223
 JORDAN                    |   1994 | 4665946594.59036
 JORDAN                    |   1993 | 4623287349.81365
 JORDAN                    |   1992 |   4653677334.831
 KENYA                     |   1998 | 2745602028.77479
 KENYA                     |   1997 | 4639195717.09117
 KENYA                     |   1996 | 4670371937.14472
 KENYA                     |   1995 | 4675041302.49597
 KENYA                     |   1994 | 4644280278.63859
 KENYA                     |   1993 | 4652905430.78687
 KENYA                     |   1992 | 4664082777.14938
 MOROCCO                   |   1998 | 2735353761.61675
 MOROCCO                   |   1997 | 4690131626.98952
 MOROCCO                   |   1996 | 4700798952.69943
 MOROCCO                   |   1995 | 4695297222.91211
 MOROCCO                   |   1994 | 4648066879.08855
 MOROCCO                   |   1993 | 4664205589.23616
 MOROCCO                   |   1992 | 4661044385.29968
 MOZAMBIQUE                |   1998 | 2740807200.78546
 MOZAMBIQUE                |   1997 | 4653273555.41332
 MOZAMBIQUE                |   1996 | 4697290990.68398
 MOZAMBIQUE                |   1995 | 4656730917.29304
 MOZAMBIQUE                |   1994 |  4663434021.5183
 MOZAMBIQUE                |   1993 | 4658061404.27549
 MOZAMBIQUE                |   1992 | 4694129602.78105
 PERU                      |   1998 | 2697440656.13151
 PERU                      |   1997 | 4614424385.21686
 PERU                      |   1996 | 4629717522.74666
 PERU                      |   1995 | 4636026027.87392
 PERU                      |   1994 | 4622427427.19123
 PERU                      |   1993 | 4612512007.52225
 PERU                      |   1992 | 4639923385.17621
 ROMANIA                   |   1998 | 2748834226.51186
 ROMANIA                   |   1997 | 4696640939.23234
 ROMANIA                   |   1996 |  4667742910.8018
 ROMANIA                   |   1995 | 4690844845.66389
 ROMANIA                   |   1994 | 4688938046.60492
 ROMANIA                   |   1993 | 4667233749.73878
 ROMANIA                   |   1992 | 4698220609.55888
 RUSSIA                    |   1998 | 2722562066.68692
 RUSSIA                    |   1997 | 4698156580.28456
 RUSSIA                    |   1996 | 4657029814.18803
 RUSSIA                    |   1995 | 4657526285.63548
 RUSSIA                    |   1994 | 4658782768.24638
 RUSSIA                    |   1993 | 4675606562.44063
 RUSSIA                    |   1992 | 4688015865.44056
 SAUDI ARABIA              |   1998 | 2717957672.90286
 SAUDI ARABIA              |   1997 | 4635022729.38265
 SAUDI ARABIA              |   1996 | 4700248945.46042
 SAUDI ARABIA              |   1995 | 4663750689.62129
 SAUDI ARABIA              |   1994 | 4675391129.56793
 SAUDI ARABIA              |   1993 | 4662763238.48524
 SAUDI ARABIA              |   1992 | 4673401649.02372
 UNITED KINGDOM            |   1998 |  2749693692.8003
 UNITED KINGDOM            |   1997 | 4691225144.19422
 UNITED KINGDOM            |   1996 | 4696190173.39534
 UNITED KINGDOM            |   1995 | 4656634295.50771
 UNITED KINGDOM            |   1994 | 4698054800.99089
 UNITED KINGDOM            |   1993 | 4696805527.53943
 UNITED KINGDOM            |   1992 | 4708371840.26355
 UNITED STATES             |   1998 | 2763936291.29522
 UNITED STATES             |   1997 | 4691607249.92698
 UNITED STATES             |   1996 | 4715060133.15028
 UNITED STATES             |   1995 | 4653454931.59386
 UNITED STATES             |   1994 | 4671706360.68235
 UNITED STATES             |   1993 | 4691718203.72712
 UNITED STATES             |   1992 | 4716794417.30586
 VIETNAM                   |   1998 | 2747781934.14876
 VIETNAM                   |   1997 | 4687736239.56263
 VIETNAM                   |   1996 | 4681711330.16308
 VIETNAM                   |   1995 | 4679857220.77852
 VIETNAM                   |   1994 |  4701573078.6419
 VIETNAM                   |   1993 | 4683613256.18353
 VIETNAM                   |   1992 | 4689385600.07645
(175 rows)

COMMIT;
COMMIT
