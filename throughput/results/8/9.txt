BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%firebrick%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2735906139.08799
 ALGERIA                   |   1997 | 4674721742.94769
 ALGERIA                   |   1996 | 4682572062.83877
 ALGERIA                   |   1995 | 4693403486.84997
 ALGERIA                   |   1994 |  4683800783.1604
 ALGERIA                   |   1993 | 4689906876.04916
 ALGERIA                   |   1992 | 4681989350.84895
 ARGENTINA                 |   1998 |  2707118561.9376
 ARGENTINA                 |   1997 | 4659151032.94624
 ARGENTINA                 |   1996 | 4665854986.45365
 ARGENTINA                 |   1995 |  4660901174.7624
 ARGENTINA                 |   1994 | 4655880995.80903
 ARGENTINA                 |   1993 | 4670808746.69932
 ARGENTINA                 |   1992 | 4641177897.26728
 BRAZIL                    |   1998 | 2745769671.79838
 BRAZIL                    |   1997 | 4687404491.93404
 BRAZIL                    |   1996 | 4690486748.93892
 BRAZIL                    |   1995 |  4682603447.9322
 BRAZIL                    |   1994 |  4652156125.6104
 BRAZIL                    |   1993 | 4706870424.19865
 BRAZIL                    |   1992 |  4678008919.5174
 CANADA                    |   1998 | 2755396983.20044
 CANADA                    |   1997 | 4671596059.14846
 CANADA                    |   1996 | 4690063591.47461
 CANADA                    |   1995 | 4680975827.86094
 CANADA                    |   1994 | 4692022831.70974
 CANADA                    |   1993 | 4680784775.91109
 CANADA                    |   1992 |  4681620718.2705
 CHINA                     |   1998 | 2722422855.73424
 CHINA                     |   1997 | 4669908977.17153
 CHINA                     |   1996 |  4662033198.2359
 CHINA                     |   1995 | 4671191739.91364
 CHINA                     |   1994 | 4675923926.77795
 CHINA                     |   1993 | 4665202881.43203
 CHINA                     |   1992 | 4659047524.32229
 EGYPT                     |   1998 |   2738368213.609
 EGYPT                     |   1997 | 4649207491.52396
 EGYPT                     |   1996 | 4661328311.33696
 EGYPT                     |   1995 | 4685322753.63971
 EGYPT                     |   1994 | 4656922906.32471
 EGYPT                     |   1993 | 4671474364.81773
 EGYPT                     |   1992 | 4690927552.32558
 ETHIOPIA                  |   1998 | 2774007912.20558
 ETHIOPIA                  |   1997 | 4719388627.03598
 ETHIOPIA                  |   1996 | 4749306054.69562
 ETHIOPIA                  |   1995 | 4714235999.90148
 ETHIOPIA                  |   1994 |   4730924514.818
 ETHIOPIA                  |   1993 | 4729367685.78581
 ETHIOPIA                  |   1992 | 4713196146.60249
 FRANCE                    |   1998 | 2748322818.19893
 FRANCE                    |   1997 | 4729602372.38756
 FRANCE                    |   1996 | 4714491423.90447
 FRANCE                    |   1995 | 4695381032.97353
 FRANCE                    |   1994 | 4703905032.42596
 FRANCE                    |   1993 | 4699085145.95385
 FRANCE                    |   1992 | 4699039173.64592
 GERMANY                   |   1998 | 2740450732.17427
 GERMANY                   |   1997 | 4655661949.29534
 GERMANY                   |   1996 | 4665209839.45888
 GERMANY                   |   1995 |  4665308524.5235
 GERMANY                   |   1994 | 4671469892.37287
 GERMANY                   |   1993 | 4672793217.67088
 GERMANY                   |   1992 | 4696026520.68462
 INDIA                     |   1998 |  2726782781.0557
 INDIA                     |   1997 | 4663102543.52069
 INDIA                     |   1996 | 4692951076.43191
 INDIA                     |   1995 | 4662921130.97968
 INDIA                     |   1994 | 4680733243.15231
 INDIA                     |   1993 | 4669311554.27865
 INDIA                     |   1992 | 4693275614.34658
 INDONESIA                 |   1998 | 2728458932.85116
 INDONESIA                 |   1997 | 4646257957.95388
 INDONESIA                 |   1996 | 4613014101.95117
 INDONESIA                 |   1995 | 4623325796.81563
 INDONESIA                 |   1994 | 4616532661.41159
 INDONESIA                 |   1993 | 4634788613.21298
 INDONESIA                 |   1992 | 4633228420.71621
 IRAN                      |   1998 | 2719590518.88796
 IRAN                      |   1997 | 4666849260.23477
 IRAN                      |   1996 | 4691630746.58522
 IRAN                      |   1995 |  4669286214.7072
 IRAN                      |   1994 | 4653302311.65887
 IRAN                      |   1993 | 4680155155.27837
 IRAN                      |   1992 | 4682816089.62537
 IRAQ                      |   1998 | 2737445656.75351
 IRAQ                      |   1997 | 4680534705.49505
 IRAQ                      |   1996 |  4670838019.6921
 IRAQ                      |   1995 | 4636890064.36485
 IRAQ                      |   1994 | 4657190247.80871
 IRAQ                      |   1993 | 4648833544.84212
 IRAQ                      |   1992 | 4661675622.31805
 JAPAN                     |   1998 | 2752480134.69458
 JAPAN                     |   1997 | 4655282925.62789
 JAPAN                     |   1996 | 4676547951.22542
 JAPAN                     |   1995 |  4663381000.3721
 JAPAN                     |   1994 | 4671678709.98634
 JAPAN                     |   1993 | 4653132942.86901
 JAPAN                     |   1992 | 4665579210.74795
 JORDAN                    |   1998 | 2703825224.51732
 JORDAN                    |   1997 | 4646011654.83146
 JORDAN                    |   1996 | 4670715127.03062
 JORDAN                    |   1995 | 4642962542.93001
 JORDAN                    |   1994 | 4641447869.11718
 JORDAN                    |   1993 | 4636598866.88047
 JORDAN                    |   1992 | 4671659751.34747
 KENYA                     |   1998 | 2724921525.93085
 KENYA                     |   1997 |  4631046142.7316
 KENYA                     |   1996 | 4616572305.23801
 KENYA                     |   1995 | 4622748383.42962
 KENYA                     |   1994 | 4622990008.67911
 KENYA                     |   1993 | 4645198830.31049
 KENYA                     |   1992 | 4601013549.64958
 MOROCCO                   |   1998 | 2750164476.61229
 MOROCCO                   |   1997 |  4725350938.4637
 MOROCCO                   |   1996 | 4735566018.39706
 MOROCCO                   |   1995 | 4660556203.62877
 MOROCCO                   |   1994 | 4716043360.98857
 MOROCCO                   |   1993 | 4712816553.40551
 MOROCCO                   |   1992 | 4705206299.77617
 MOZAMBIQUE                |   1998 | 2738595710.09253
 MOZAMBIQUE                |   1997 | 4655724669.61082
 MOZAMBIQUE                |   1996 | 4691689953.27034
 MOZAMBIQUE                |   1995 |  4628303863.9583
 MOZAMBIQUE                |   1994 | 4629432710.58408
 MOZAMBIQUE                |   1993 | 4627112681.99741
 MOZAMBIQUE                |   1992 |  4660322051.3237
 PERU                      |   1998 | 2705231722.54728
 PERU                      |   1997 |  4640581694.9858
 PERU                      |   1996 | 4643877238.73528
 PERU                      |   1995 | 4625574968.28146
 PERU                      |   1994 | 4644784969.53243
 PERU                      |   1993 | 4670645063.48033
 PERU                      |   1992 | 4635842201.25183
 ROMANIA                   |   1998 | 2757932118.68812
 ROMANIA                   |   1997 | 4679085062.76595
 ROMANIA                   |   1996 |  4699758179.2994
 ROMANIA                   |   1995 | 4705092526.82231
 ROMANIA                   |   1994 | 4692590743.23547
 ROMANIA                   |   1993 | 4681634613.05498
 ROMANIA                   |   1992 | 4697087218.32349
 RUSSIA                    |   1998 | 2726607695.30389
 RUSSIA                    |   1997 | 4683274597.57128
 RUSSIA                    |   1996 | 4702885767.76016
 RUSSIA                    |   1995 |  4680754519.9722
 RUSSIA                    |   1994 | 4689595340.47756
 RUSSIA                    |   1993 | 4684325191.55943
 RUSSIA                    |   1992 |  4669926301.3698
 SAUDI ARABIA              |   1998 | 2728201698.09443
 SAUDI ARABIA              |   1997 | 4631316756.46812
 SAUDI ARABIA              |   1996 | 4687289696.56717
 SAUDI ARABIA              |   1995 | 4671930263.01916
 SAUDI ARABIA              |   1994 | 4659513402.47915
 SAUDI ARABIA              |   1993 |   4643764545.969
 SAUDI ARABIA              |   1992 | 4670599676.72655
 UNITED KINGDOM            |   1998 |  2763710185.4505
 UNITED KINGDOM            |   1997 | 4726124845.01812
 UNITED KINGDOM            |   1996 | 4709653529.66068
 UNITED KINGDOM            |   1995 | 4693311268.69018
 UNITED KINGDOM            |   1994 | 4688544849.52521
 UNITED KINGDOM            |   1993 | 4667590311.83172
 UNITED KINGDOM            |   1992 | 4709330440.96918
 UNITED STATES             |   1998 | 2748252033.93573
 UNITED STATES             |   1997 | 4689235132.12903
 UNITED STATES             |   1996 | 4678748207.73507
 UNITED STATES             |   1995 | 4673804405.48125
 UNITED STATES             |   1994 | 4695430055.83551
 UNITED STATES             |   1993 | 4665776672.18638
 UNITED STATES             |   1992 | 4723754695.33965
 VIETNAM                   |   1998 | 2763751670.59496
 VIETNAM                   |   1997 | 4700719125.61718
 VIETNAM                   |   1996 | 4737223837.97775
 VIETNAM                   |   1995 | 4702287864.31979
 VIETNAM                   |   1994 | 4744551580.17861
 VIETNAM                   |   1993 | 4695497031.43923
 VIETNAM                   |   1992 | 4715805226.68002
(175 rows)

COMMIT;
COMMIT
